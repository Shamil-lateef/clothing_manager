{% extends 'base.html' %}
{% block content %}
<div class="mb-4">
  <div class="row g-2">
    <div class="col-md-3">
      <a href="{{ url_for('search_by_size') }}" class="btn btn-info w-100">üîç Search by Size</a>
    </div>
    <div class="col-md-3">
      <a href="{{ url_for('sell_product') }}" class="btn btn-warning w-100">üí∞ Sell Product</a>
    </div>
    <div class="col-md-3">
      <a href="{{ url_for('add_product') }}" class="btn btn-success w-100">‚ûï Add Product</a>
    </div>
    <div class="col-md-3">
      <a href="{{ url_for('report') }}" class="btn btn-primary w-100">üìä Reports</a>
    </div>
  </div>
</div>

<div class="row row-cols-1 row-cols-md-2 g-4">
    {% for product in products %}
    <div class="col">
      <div class="card h-100">
        <img src="{{ product.image_url }}" class="img-fluid mb-2" alt="Product Image">

        <div class="card-body">
          <h5 class="card-title"><a href="{{ product.style_url }}" target="_blank">View Style</a></h5>
          <p><strong>Price:</strong> {{ product.selling_price|int }} IQD</p>
          <p><strong>Stock:</strong></p>
          <ul>
            {% for sq in product.sizes %}
              <li {% if sq.quantity <= 1 %} style="color: red; font-weight: bold;" {% endif %}>
                Size {{ sq.size }}:   {{ sq.quantity }}   sets available
                {% if sq.quantity <= 1 %} ‚ö†Ô∏è Low Stock {% endif %}
              </li>
            {% endfor %}
          </ul>
          
          <a href="{{ url_for('edit_product', product_id=product.id) }}" class="btn btn-sm btn-warning me-2">Edit</a>

            <form action="{{ url_for('delete_product', product_id=product.id) }}" method="POST" style="display:inline-block;" onsubmit="return confirm('Are you sure?');">
            <button class="btn btn-sm btn-danger">Delete</button>
            </form>

        </div>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}